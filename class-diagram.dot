digraph G {
  rankdir = TB;
  node [shape = record];
  { rank = same;
    main  [label = "{main   | + setup(): void\n+ loop(): void}"];
    brick [label = "{brick  | + color: int\n+ size_x: int\n+ size_y: int\n+ size_z: int}"];
  }
  sensor       [label = "{sensor | + pin: int}"];
  sensor_size  [label = "{size   | + get_size(): int}"];
  sensor_color [label = "{color  | + get_color(): int}"];

  {sensor_size, sensor_color}  -> sensor [arrowhead = onormal];

  comp [label = "{component | + detect_brick(): void}"];

  module_compute [label = "{controller | - registered_bricks: vector\<brick\> | +register_brick(brick)\n+ register_component(component): Void}"];
  module_pusher  [label = "{pusher     | + open(): void\n+ close(): void\n+ brick_detected(): bool}"];
  module_memory  [label = "{memory     | - bricks: brick[][] | + enqueue(brick): void\n+ dequeue(): brick}"];
  module_motor   [label = "{motor      | + motor(byte, int)\n+ run_forward(bool): void\nrun_backward(bool): void\n+ stop(bool): void}"];

  {sensor, module_pusher, module_motor} -> comp [arrowhead = onormal];

  module_compute -> {module_memory} [style = dashed, arrowhead = vee];
  comp -> module_compute [arrowhead = vee];

  blueprint [label = "{blueprint | - required_bricks: vector\<brick\> | + is_brick_useful(brick): bool}"];

  module_compute -> blueprint [style = dashed, arrowhead = vee];
  {blueprint, module_compute, module_memory} -> brick [arrowhead = vee];
  {module_compute, sensor} -> main [dir = back];
}
